<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset='utf-8'>
  <meta http-equiv='X-UA-Compatible' content='IE=edge'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>

  <title>Stock Research || 1.2. 머신러닝 모델 비교</title>
  <meta name='description' content="1. baseline model1.2 머신러닝 모델 비교">
  <link rel='canonical' href="https://ag-su.github.io/myblog/2022/07/08/model-selection/">
  <link rel='alternate' type='application/rss+xml' title='agsu BLOG' href="https://ag-su.github.io/myblog/feed.xml">
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Volkhov:400,700" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">

  <style>
    
    @font-face{font-family:'Cafe24Oneprettynight';src:url("https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_twelve@1.1/Cafe24Oneprettynight.woff") format("woff");font-weight:normal;font-style:normal}/*! normalize.css v7.0.0 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:0.67em 0}figcaption,figure,main{display:block}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent;-webkit-text-decoration-skip:objects}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}dfn{font-style:italic}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:sans-serif;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,html [type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item}canvas{display:inline-block}template{display:none}[hidden]{display:none}body,h1,h2,h3,h4,h5,h6,p,blockquote,pre,dl,dd,ol,ul,fieldset,legend,figure,hr{margin:0;padding:0}li>ul,li>ol{margin-bottom:0}table{border-collapse:collapse;border-spacing:0}@-webkit-keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.icon{position:relative;display:inline-block;width:25px;height:25px;overflow:hidden;fill:currentColor}.icon__cnt{width:100%;height:100%;background:inherit;fill:inherit;pointer-events:none;transform:translateX(0);-ms-transform:translate(0.5px, -0.3px)}.icon--m{width:50px;height:50px}.icon--l{width:100px;height:100px}.icon--xl{width:150px;height:150px}.icon--xxl{width:200px;height:200px}.icon__spinner{position:absolute;top:0;left:0;width:100%;height:100%}.icon--ei-spinner .icon__spinner,.icon--ei-spinner-2 .icon__spinner{-webkit-animation:spin 1s steps(12) infinite;animation:spin 1s steps(12) infinite}.icon--ei-spinner-3 .icon__spinner{-webkit-animation:spin 1.5s linear infinite;animation:spin 1.5s linear infinite}.icon--ei-sc-facebook{fill:#3b5998}.icon--ei-sc-github{fill:#333}.icon--ei-sc-google-plus{fill:#dd4b39}.icon--ei-sc-instagram{fill:#3f729b}.icon--ei-sc-linkedin{fill:#0976b4}.icon--ei-sc-odnoklassniki{fill:#ed812b}.icon--ei-sc-skype{fill:#00aff0}.icon--ei-sc-soundcloud{fill:#f80}.icon--ei-sc-tumblr{fill:#35465c}.icon--ei-sc-twitter{fill:#55acee}.icon--ei-sc-vimeo{fill:#1ab7ea}.icon--ei-sc-vk{fill:#45668e}.icon--ei-sc-youtube{fill:#e52d27}.icon--ei-sc-pinterest{fill:#bd081c}.icon--ei-sc-telegram{fill:#0088cc}*,*::after,*::before{box-sizing:border-box}h1,h2,h3,h4,h5,h6,ul,ol,dl,blockquote,p,address,hr,table,fieldset,figure,pre{margin-bottom:15px}ul,ol,dd{margin-left:15px}@font-face{font-family:'D2 coding';src:url("http://cdn.jsdelivr.net/gh/joungkyun/font-d2coding/d2coding.css") format("text/css");font-weight:normal;font-style:normal}.highlight{background:#f0f0f082;font-family:'D2 coding'}.highlighter-rouge .highlight{background:#f0f0f082}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{color:#29843b;font-weight:bold}.highlight .o{color:#c917ed;font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#416373;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#aaa}.highlight .gt{color:#a00}.highlight .kn{color:#29843b;font-weight:bold}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#bc0202}.highlight .n{color:#000}.highlight .na{color:#008080}.highlight .nb{color:#29843b;font-weight:bold}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#150dff;font-weight:500}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold;color:#7590b7}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#29843b;font-weight:bold}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#bc0202}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:#008080}.highlight .vg{color:#008080}.highlight .vi{color:#008080}.highlight .il{color:#099}.highlight .p{color:#000}body{font-family:"Cafe24Oneprettynight";font-size:19px;line-height:28px;color:#404040;background-color:#fbfbfb;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*::selection{color:#fff;background-color:#df2252}h1,h2,h3,h4,h5,h6{font-family:"Cafe24Oneprettynight";font-weight:400;line-height:initial}h1{font-size:32px}h2{font-size:28px}h3{font-size:24px}h4{font-size:20px}h5{font-size:18px}h6{font-size:16px}img{max-width:100%;height:auto;vertical-align:middle}a{text-decoration:none;color:#3af;transition:.35s}a:hover{color:#0086e6}blockquote{padding-left:15px;border-left:3px solid #3af;font-family:'Volkhov', 'Times New Roman', Times, serif;font-style:normal;font-size:18px;background-color:rgba(220,235,245,0.2)}blockquote p{padding:10px}hr{height:1px;margin:30px 0;border:0;background-color:#f0f0f0}pre{overflow:auto;padding:25px;font-size:14px;white-space:pre-wrap;word-wrap:break-word;word-break:break-all;font-family:Courier, monospace}code{color:#928b8b;overflow:auto;white-space:pre-wrap;word-wrap:break-word;word-break:break-all;font-family:Courier, monospace;font-size:14px}p code,li code{padding:3px 5px}.o-wrapper{max-width:1440px;position:relative}.o-opacity{animation-duration:0.7s;animation-delay:0.2s;animation-fill-mode:both;animation-name:opacity}@keyframes opacity{from{opacity:0}to{opacity:1}}.c-btn{display:inline-block;white-space:nowrap;vertical-align:middle;font-family:'Volkhov', serif;font-size:12px;text-align:center;padding:8px 15px;cursor:pointer;transition:.35s}.c-btn--primary{color:#fff;background-color:#3af;background:linear-gradient(135deg, #3af 0%, #62d5ff 100%)}.c-btn--secondary{color:#fff;background-color:#cfcfdd;background:linear-gradient(135deg, #a2a2bd 0%, #cfcfdd 100%)}.c-btn--round{border-radius:30px}.c-btn--shadow{box-shadow:8px 10px 20px 0 rgba(46,61,73,0.15)}.c-btn--shadow:hover{box-shadow:2px 4px 8px 0px rgba(46,61,73,0.2)}.c-btn--middle{display:block;width:300px;max-width:100%}.c-btn--big{display:block;width:100%}.c-btn:hover{color:#fff;transition:.35s}.c-btn:active{transform:translateY(2px)}.c-sidebar{display:flex;flex-direction:column;justify-content:space-between;position:fixed;top:0;left:0;bottom:0;width:360px;padding:40px 20px 20px;text-align:center;box-shadow:1px 1px 0 rgba(31,35,46,0.15);background-color:#fff}.c-sidebar-author .c-author__cover{width:100px;height:100px;margin:0 auto 10px;border-radius:50%;overflow:hidden;background-color:#cfcfdd}.c-sidebar-author .c-author__cover img{width:100%;height:100%;border-radius:50%;transition:.35s}.c-sidebar-author .c-author__cover img:hover{transform:scale3d(0.9, 0.9, 1)}.c-sidebar-author .c-contact-menu .c-btn{min-width:110px}.c-sidebar-author .c-contact-menu .c-btn .icon{width:18px;height:18px;vertical-align:text-bottom;fill:#fff}.c-sidebar-author .c-author__info{font-family:'Volkhov', serif}.c-sidebar-author .c-author__name{font-size:18px;font-weight:700;line-height:21px}.c-sidebar-author .c-author__job{font-size:12px;color:#a0a0a0;margin:5px 0 0}.c-sidebar-author .c-contact-menu{margin:30px 0}.c-sidebar-author .c-contact-menu .c-btn--secondary{margin-right:10px}.c-sidebar-author .c-author__about{max-width:400px;margin:0 auto 15px;font-size:13px}.c-sidebar-footer .c-social__title{position:relative;font-family:'Volkhov', serif;font-size:15px;font-weight:700;color:#444}.c-sidebar-footer .c-social__title::before{content:"";display:block;height:2px;width:calc(50% - 40px);transform:translateY(-50%);position:absolute;top:50%;left:0;background-color:#444}.c-sidebar-footer .c-social__title::after{content:"";display:block;height:2px;width:calc(50% - 40px);transform:translateY(-50%);position:absolute;top:50%;right:0;background-color:#444}.c-sidebar-footer .c-social__list{list-style-type:none;padding:0;margin:15px 0}.c-sidebar-footer .c-social__list .c-social__item{display:inline-block;width:27px;height:27px}.c-sidebar-footer .c-social__list .icon{width:27px;height:27px;fill:#444;vertical-align:middle;transition:.35s}.c-sidebar-footer .c-social__list .icon:hover{fill:#3af;transform:scale(1.2);transition:.35s}.c-sidebar-footer .c-copyright p{font-size:13px;margin:0}@media only screen and (max-width: 900px){.c-sidebar{position:relative;width:100%;padding:20px}.c-sidebar .c-contact-menu{margin:20px 0}.c-sidebar-footer .c-social .c-social__title{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}.c-sidebar-footer .c-social__list{margin:0}.c-sidebar-footer .c-copyright{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}}@media only screen and (max-width: 480px){.c-sidebar-author .c-author__cover{width:80px;height:80px}.c-sidebar-author .c-author__cover img{width:100%;height:100%}.c-sidebar-author .c-contact-menu{margin:15px 0}.c-sidebar-author .c-contact-menu .c-btn{min-width:80px;font-size:10px;padding:4px 15px;margin-right:5px}.c-sidebar-author .c-contact-menu .c-btn .icon{width:16px;height:16px}.c-sidebar-footer .c-social .c-social__title{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}.c-sidebar-footer .c-social__list{margin:0}.c-sidebar-footer .c-social__list .icon{width:25px;height:25px}.c-sidebar-footer .c-copyright{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}}.c-content{position:relative;display:flex;flex-direction:row;flex-wrap:wrap;align-items:stretch;padding:0 20px 0;margin-left:360px}@media only screen and (max-width: 900px){.c-content{position:static;padding:0 15px 0;margin-left:0}}.c-posts{width:100%;display:flex;flex-direction:row;flex-wrap:wrap}.c-post{width:100%;max-width:100%;margin-bottom:20px;display:flex;flex-direction:row;align-items:stretch;min-height:180px;border-radius:10px;overflow:hidden;transition:.35s;background-color:#fff;box-shadow:0 1px 1px 0 rgba(31,35,46,0.15)}.c-post:hover{transform:translate(0px, -2px);box-shadow:0 15px 45px -10px rgba(10,16,34,0.2)}.c-post .c-post-thumbnail{display:block;width:30%;max-width:100%;min-height:180px;border-radius:10px 0 0 10px;background-color:rgba(220,235,245,0.2);background-size:cover;background-position:50% 50%}.c-post .c-post-content{padding:15px;width:70%}.c-post .c-post-content .c-post-title{font-size:30px;font-weight:400;margin:0 0 15px}.c-post .c-post-content .c-post-title a{text-decoration:none;color:#263959}.c-post .c-post-content .c-post-date,.c-post .c-post-content .c-post-words{font-size:12px}.c-load-more{padding:20px;margin:20px auto 40px;font-size:13px;color:#fff;border:none;background-color:#d0a9ae;outline:none}.c-load-more:hover{background-color:#0086e6}@media only screen and (max-width: 1200px){.c-post{width:48%;max-width:100%;margin:0 1% 20px;flex-direction:column}.c-post .c-post-thumbnail{width:100%;border-radius:10px 10px 0 0}.c-post .c-post-content{width:100%}.c-post .c-post-content .c-post-title{font-size:21px;margin:15px 0}}@media only screen and (max-width: 480px){.c-post{width:100%;max-width:100%;margin:0 0 20px}.c-post .c-post-content{width:100%}.c-post .c-post-content .c-post-title{font-size:21px;margin:15px 0}}.c-article{width:100%;margin:20px 0}.c-wrap-content{padding:20px;background-color:#fff}.c-article__image{position:relative;background-color:rgba(220,235,245,0.2);background-position:center;background-size:cover;background-repeat:no-repeat}.c-article__image:after{content:"";display:block;padding-top:56%}.c-article__header{margin-bottom:20px;text-align:center}.c-article__header .c-article__title{margin-bottom:10px}.c-article__date span{font-size:13px;text-transform:uppercase;color:#a0a0a0}.c-article__footer{margin:30px 0 0;padding-bottom:30px;text-align:center;border-bottom:1px solid #f0f0f0}.c-article__footer .c-article__share{transition:.35s}.c-article__footer .c-article__share a .icon{vertical-align:middle;transition:.35s}.c-article__footer .c-article__share a .icon:hover{opacity:.7;transition:.35s}.c-article__footer .c-article__tag{margin-bottom:5px}.c-article__footer .c-article__tag a{display:inline-block;vertical-align:middle;padding:5px 10px;font-family:'Volkhov', 'Times New Roman', Times, serif;font-size:10px;line-height:10px;text-transform:uppercase;background-color:rgba(115,138,160,0.6);color:#fff}.c-article__footer .c-article__tag a:hover{background-color:rgba(80,100,118,0.6)}.c-article__footer .c-article__tag a:last-child{margin-right:0}.c-recent-post{padding:30px 0}.c-recent-post .c-recent__title{font-size:14px;text-align:center;text-transform:uppercase;margin-bottom:30px}.c-recent-post .c-recent__box{display:flex;flex-direction:row;flex-wrap:wrap}.c-recent-post .c-recent__item{max-width:23%;flex-basis:23%;margin:0 1% 20px;border-radius:10px;overflow:hidden;text-align:center;background-color:#fff;box-shadow:0 1px 1px 0 rgba(31,35,46,0.15);transition:.35s}.c-recent-post .c-recent__item h4{margin-bottom:5px;font-size:12px;text-transform:uppercase}.c-recent-post .c-recent__item h4 a{color:#444}.c-recent-post .c-recent__item:hover{box-shadow:2px 4px 8px 0px rgba(46,61,73,0.2)}.c-recent-post .c-recent__footer{padding:15px}.c-recent-post .c-recent__image{display:block;width:100%;min-height:180px;background-color:rgba(220,235,245,0.2);background-size:cover;background-position:center;background-repeat:no-repeat}.c-recent-post .c-recent__date{color:#a0a0a0;font-size:12px}@media only screen and (max-width: 1200px){.c-recent-post .c-recent__item{max-width:48%;flex-basis:48%}}@media only screen and (max-width: 900px){.c-article{margin:15px 0}}@media only screen and (max-width: 480px){.c-wrap-content{padding:15px}.c-article__header{margin-bottom:5px}.c-article__header .c-article__title{font-size:24px;margin-bottom:5px}.c-recent-post .c-recent__item{max-width:100%;flex-basis:100%;margin:0 0 20px}}.c-blog-tags{width:100%;padding:20px;margin:20px 0 40px;background-color:#fff}.c-blog-tags h1{text-align:center;margin-bottom:0}.c-blog-tags h2{font-size:18px;text-transform:uppercase;margin:30px 0;color:#757575}.c-tag__list{list-style:none;padding:0 0 40px;margin:40px 0 0;border-bottom:1px solid #f0f0f0}.c-tag__list li{display:inline-block;margin-right:15px}.c-tag__list li a{color:#404040;text-transform:uppercase;font-size:12px}.c-tag__list li a:hover{color:#000}.c-tag__item{margin-bottom:15px}.c-tag__image{width:50px;height:50px;border-radius:50%;margin-right:5px}@media only screen and (max-width: 480px){.c-blog-tags{padding:15px}.c-blog-tags h1{font-size:27px}.c-blog-tags h2{font-size:16px;margin:15px 0}.c-tag__list{padding:0 0 30px;margin:30px 0 0}.c-tag__item{margin-bottom:5px}.c-tag__image{display:none}}.c-header{position:relative;width:100%;margin:20px 0}.c-header__box{position:relative;display:flex;flex-direction:row;justify-content:space-between;align-items:center}.c-header__box .icon--ei-search{position:absolute;top:7px;left:15px;fill:#ccc}.c-search{width:80%}.c-search .c-search__box{display:flex;align-items:center}.c-search .c-search__text{position:relative;width:100%;padding:10px 10px 10px 40px;border:1px solid #dce4ea;border-radius:30px;outline:none;color:#a0a0a0}.c-search .c-search__text::placeholder{color:#ccc}.c-search .c-search__text:hover{box-shadow:0 1px 0px rgba(132,135,138,0.1);transition:.35s}.c-search .c-search-results-list{position:absolute;width:100%;margin:10px 0 0;list-style-type:none;background-color:#fff;z-index:1}.c-search .c-search-results-list li{display:flex;flex-wrap:wrap;align-items:center;margin:0;padding:20px 25px 0;background-color:#fff;line-height:1.4;border-left:solid 1px #edeeee;border-right:solid 1px #edeeee}.c-search .c-search-results-list li:first-child{border-top-left-radius:5px;border-top-right-radius:5px;border-top:solid 1px #edeeee}.c-search .c-search-results-list li:last-child{border-bottom-left-radius:5px;border-bottom-right-radius:5px;padding-bottom:25px;border-bottom:solid 1px #edeeee}.c-search .c-search-results-list li a{font-size:16px}.c-nav{flex-grow:1;padding-left:20px}.c-nav .c-nav__list{display:flex;justify-content:flex-end}.c-nav .c-nav__list .c-nav__item{display:flex;align-items:center;float:left;padding:4px 10px;font-size:10px;text-transform:uppercase;white-space:nowrap;border:1px solid #dce4ea;box-shadow:0 1px 0px rgba(132,135,138,0.4);will-change:transform;transform:translateY(0px);cursor:pointer}.c-nav .c-nav__list .c-nav__item:hover{color:#222;background-color:#fff}.c-nav .c-nav__list .c-nav__item.is-active{box-shadow:0 0 0 rgba(132,135,138,0.5);transform:translateY(1px);color:#cfcfdd}.c-nav .c-nav__list .c-nav__item.is-active:hover{background-color:#fbfbfb}.c-nav .c-nav__list .c-nav__item:first-child{border-radius:10px 0 0 10px}.c-nav .c-nav__list .c-nav__item:last-child{border-radius:0 10px 10px 0}.c-nav .c-nav__list .c-nav__item .icon{width:18px;height:18px;margin-right:3px}@media only screen and (max-width: 900px){.c-header{margin:15px 0}}@media only screen and (max-width: 480px){.c-header .c-header__box{flex-direction:column}.c-header .c-search{width:100%}.c-header .c-search .c-search__text{padding:8px 8px 8px 40px}.c-header .c-nav{margin-top:15px}.c-header .c-nav .c-nav__list{justify-content:center}.c-header .c-nav .c-nav__item{padding:4px 8px}}.c-categories{width:100%}.c-categories__list{width:100%;display:flex;flex-direction:row;flex-wrap:wrap}.c-categories__item{max-width:25%;flex-basis:25%;padding:0 10px 20px}.c-categories__link{height:100%;display:flex;flex-direction:column;align-items:center;padding:20px 10px;border-radius:5px;box-shadow:5px 5px 25px rgba(46,61,73,0.15);background-color:#fff;transition:.35s}.c-categories__link:hover{box-shadow:2px 4px 8px 0px rgba(46,61,73,0.2)}.c-categories__link:hover .c-categories__img .c-categories__more{opacity:1;transition:.35s}.c-categories__link .c-categories__container{width:100%;word-wrap:break-word}.c-categories__link .c-categories__container.c-empty-figure{display:flex;flex-direction:column;justify-content:center;flex-grow:1}.c-categories__img{position:relative;max-width:100%}.c-categories__img figure{position:relative;width:200px;max-width:100%;margin-bottom:20px;overflow:hidden;background-size:cover;background-repeat:no-repeat;background-position:center;border-radius:50%;box-shadow:inset 0 1px 3px rgba(141,165,185,0.3)}.c-categories__img figure:after{content:"";display:block;padding-top:100%}.c-categories__img figure:before{content:"";position:absolute;top:0;bottom:0;left:0;right:0;background-color:rgba(0,0,0,0.15)}.c-categories__img .c-categories__more{display:inline-block;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);font-weight:700;color:#fff;text-transform:uppercase;text-shadow:0 1px 0 rgba(104,172,191,0.3);opacity:0;transition:.35s}.c-categories__container{text-align:center}.c-categories__container .c-categories__header{font-size:13px;margin-bottom:10px;font-weight:normal;text-transform:uppercase;color:#404040}.c-categories__container .c-categories__count{font-family:'Volkhov', serif;font-size:12px;color:#404040;margin-bottom:0}.c-categories__container .c-categories__count span{display:inline-block;width:20px;height:20px;line-height:20px;vertical-align:baseline;margin-right:5px;border-radius:50%;color:#fff;background-color:#ee6c6c}@media only screen and (max-width: 1200px){.c-categories .c-categories__item{max-width:33.333%;flex-basis:33.333%}}@media only screen and (max-width: 1050px){.c-categories .c-categories__item{max-width:50%;flex-basis:50%}}@media only screen and (max-width: 480px){.c-categories .c-categories__item{max-width:100%;flex-basis:100%;padding:0 0 20px}}.c-form-box{position:absolute;top:0;width:calc(100% - 40px);min-height:100vh;padding:0 20px;background-color:#fff;z-index:1}.c-form-bnt__close{position:absolute;top:0px;left:0;width:30px;height:30px;cursor:pointer;transition:.35s}.c-form-bnt__close:hover{transform:scale(0.8);opacity:.8}.c-form{position:relative;width:750px;max-width:100%;margin:40px auto}.c-form .c-form__title{margin:0 0 40px;min-width:0;border:0;padding:0;font-family:"Cafe24Oneprettynight";text-transform:uppercase;text-align:center}.c-form a{color:#404040}.c-form__group{margin-bottom:20px}.c-form__group label{display:block;text-transform:uppercase;font-size:10px}.c-form__group input,.c-form__group textarea{width:100%;padding:10px 15px;color:#404040;border:1px solid #dce4ea;outline:none;transition:.35s}.c-form__group input:focus,.c-form__group textarea:focus{box-shadow:0 4px 25px rgba(132,135,138,0.1)}.c-form__group button{padding:20px;text-transform:uppercase;outline:none;border:none}.c-thank-you p{position:relative;padding:20px 40px;width:750px;max-width:100%;text-transform:uppercase;font-size:12px;line-height:18px;font-weight:700;margin:40px auto 0;text-align:center;color:#fff;background:linear-gradient(135deg, #55b5ad 0%, #5ec9c5 100%)}.c-thank-you p .c-form-bnt__close{width:25px;height:25px;background:transparent}.c-thank-you p a{color:#fff}@media only screen and (max-width: 900px){.c-form-box{width:100%;left:0;right:0}}@media only screen and (max-width: 480px){.c-form-bnt__close{width:25px;height:25px}}.c-newsletter{padding:30px 0 60px;margin:0 auto;border-bottom:1px solid #f0f0f0}.c-newsletter__header{text-align:center}.c-newsletter__header .c-newsletter__title{font-size:14px;text-transform:uppercase;text-align:center}.c-newsletter__header .c-newsletter__subtitle{margin-bottom:15px}.c-newsletter-form{width:100%;max-width:750px;margin:0 auto}.c-newsletter-form .c-newsletter-form__group{display:flex}.c-newsletter__email{width:70%;height:40px;padding:10px 15px;border:1px solid #ddd;border-right-color:transparent;outline:none;transition:.35s}.c-newsletter__email:focus{box-shadow:0 4px 25px rgba(132,135,138,0.1)}.c-newsletter__button{width:30%;height:40px;color:#fff;background-color:#3af;transition:.35s;border:none;outline:none;cursor:pointer}.c-newsletter__button:hover{background-color:#0086e6}@media only screen and (max-width: 480px){.c-newsletter__button{font-size:13px}}.c-comments{padding:30px 0;border-top:1px solid #f0f0f0}.c-top{position:fixed;width:40px;height:40px;bottom:20px;color:#757575;cursor:pointer;transition:.35s;right:-100px;z-index:10;opacity:.5}.c-top--active{right:15px}.c-top:hover{color:#757575;opacity:1}.u-text-left{text-align:left}.u-text-right{text-align:right}.u-text-center{text-align:center}.u-text-justify{text-align:justify}.u-block{display:block}.u-inline-block{display:inline-block}.u-inline{display:inline}.u-full-width{display:block;width:100%}.u-vertical-center{display:flex;align-items:center;justify-content:center}.u-responsive-image{max-width:100%;height:auto;vertical-align:middle}.u-show{display:block !important}.u-hide{display:none !important}.u-invisible{visibility:hidden}.u-float-left{float:left}.u-float-right{float:right}.u-no-padding-top{padding-top:0}.u-no-padding-bottom{padding-bottom:0}.u-no-padding-left{padding-left:0}.u-no-padding-right{padding-right:0}.u-no-padding{padding:0}.u-no-margin-top{margin-top:0}.u-no-margin-bottom{margin-bottom:0}.u-no-margin-left{margin-left:0}.u-no-margin-right{margin-right:0}.u-no-margin{margin:0}.u-lists-reset{list-style-type:none;margin:0;padding:0}.u-clearfix::before,.u-clearfix::after{content:"";display:table;clear:both}.u-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px;word-wrap:normal !important}

  </style>
</head>

<body>
  
  <div class="o-wrapper">
    <aside class="c-sidebar">
  <div class="c-sidebar-author">
    <div class="c-author__cover">
      <a href="/myblog/">
        <img src="/myblog/images/jjang.png" alt="agsu">
      </a>
    </div>
    <div class="c-author__info">
      <div class="c-author__name">agsu</div>
      <span class="c-author__job">Department of Data Science</span>
    </div>
    <div class="c-contact-menu">
      
      <a href="/contact" class="c-contact-btn c-btn c-btn--secondary c-btn--round c-btn--shadow"><span data-icon='ei-envelope' data-size='s'></span> Send me</a>
      
      
      
    </div>
    <p class="c-author__about">블로그</p>
  </div>

  <div class="c-sidebar-footer">
    <div class="c-social">
      <div class="c-social__title">Social</div>
      <ul class="c-social__list u-lists-reset">
        
        
        
        
        
          <li class="c-social__item"><a href="https://github.com/artemsheludko" target="_blank"><div data-icon='ei-sc-github' data-size='s'></div></a></li>
        
        
        
        
          <li class="c-social__item"><a href="https://instagram.com/artemsheludko_" target="_blank"><div data-icon='ei-sc-instagram' data-size='s'></div></a></li>
        
        
        
        
        
        
        
      </ul>
    </div>
    <div class="c-copyright">
      <p>2022 &copy; agsu</p>
    </div>
  </div>
</aside> <!-- /.c-sidebar -->

<main class="c-content">
  <article class="c-article">
  <div class="c-article__content">
    <header class="c-header u-hide u-no-margin-top">
      <div class="c-header__box">
        <div class="c-search u-full-width">
          <div class="c-search__box">
            <label for="js-search-input" class="u-screen-reader-text">Search for Blog</label>
            <input type="text" id="js-search-input" class="c-search__text" autocomplete="off" placeholder="Type to search...">
            <div data-icon='ei-search' data-size='s'></div>
          </div>
          <ul id="js-results-container" class="c-search-results-list"></ul>
        </div>
      </div>
    </header>
    
    <div class="c-article__image o-opacity" style="background-image: url( /myblog/images/02.thumbnail.png )"></div>
    
    <div class="c-wrap-content">
      <header class="c-article__header">
        <h1 class="c-article__title">Stock Research || 1.2. 머신러닝 모델 비교</h1>
        <div class="c-article__date">
          <span>2022, Jul 08</span>
        </div>
      </header>
      <h1 id="1-baseline-model">1. baseline model</h1>
<h2 id="12-머신러닝-모델-비교">1.2 머신러닝 모델 비교</h2>

<p>이전 글 (<a href="https://ag-su.github.io/blog/stock-research/2022/07/06/stock-dataset.html">1.1. 머신러닝을 위한 주가 데이터셋 생성</a>) 에서는 머신러닝을 위한 시계열 구조의 데이터셋을 생성했다. 이번 글에서는 생성한 데이터셋을 사용하여 머신러닝 모델을 학습하고, 평가지표를 통해 여러 모델의 성능을 비교하여 가장 좋은 성능을 보이는 모델을 선택한다. 이를 통해 생성한 기본 시계열 데이터셋을 머신러닝 알고리즘으로 학습시켰을 때, 최소한의 성능과 수익률이 발생하는지 확인할 수 있고, 이를 통해 <strong><code class="language-plaintext highlighter-rouge">baseline model</code></strong>을 정의한다.</p>

<h3 id="목차">목차</h3>
<ul>
  <li>(1) 데이터 불러오기</li>
  <li>(2) 주가 예측 머신러닝 모델 학습</li>
  <li>(3) 평가지표 시각화를 통한 모델 평가</li>
  <li>(4) 모델 선택</li>
</ul>

<h3 id="필요-라이브러리-import">필요 라이브러리 import</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">FinanceDataReader</span> <span class="k">as</span> <span class="n">fdr</span>
<span class="kn">import</span> <span class="nn">pymysql</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="주가-예측-머신러닝-모델-비교">주가 예측 머신러닝 모델 비교</h2>

<h3 id="️-1-데이터-불러오기">✔️ (1) 데이터 불러오기</h3>

<p>지난 글에서 생성한 데이터셋을 불러온다. <code class="language-plaintext highlighter-rouge">train</code>은 2018.01.02 ~ 2020.12.31, <code class="language-plaintext highlighter-rouge">test</code>는 2021.01.02 ~ 2021.06.31 설정한 데이터셋이다.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">train dataset</code></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#collapse-hide
</span><span class="n">IF</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">"assignment3_sql.txt"</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">lst_code_date</span><span class="o">=</span><span class="p">[]</span>
<span class="n">trainX</span><span class="o">=</span><span class="p">[]</span>
<span class="n">trainY</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">IF</span><span class="p">:</span>
    <span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>
    <span class="n">lst_code_date</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">])</span>
    <span class="n">trainX</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">","</span><span class="p">))))</span>
    <span class="n">trainY</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">trainX</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trainX</span><span class="p">)</span>
<span class="n">trainY</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">trainY</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">test dataset</code></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#collapse-hide
</span><span class="n">IF</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="s">"assignment3_sql_test.txt"</span><span class="p">,</span><span class="s">'r'</span><span class="p">)</span>
<span class="n">lst_code_date_test</span><span class="o">=</span><span class="p">[]</span>
<span class="n">testX</span><span class="o">=</span><span class="p">[]</span>
<span class="n">testY</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">IF</span><span class="p">:</span>
    <span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">line</span><span class="p">.</span><span class="n">strip</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="p">)</span>
    <span class="n">lst_code_date_test</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">])</span>
    <span class="n">testX</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">","</span><span class="p">))))</span>
    <span class="n">testY</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="n">testX</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>
<span class="n">testY</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">testY</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">shape</code> 확인</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"train dataset: "</span><span class="p">,</span> <span class="n">trainX</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">trainY</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"test dataset: "</span><span class="p">,</span> <span class="n">testX</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">testY</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>train dataset:  (11935, 50) (11935, 1)
test dataset:  (4431, 50) (4431, 1)
</code></pre></div></div>

<h3 id="️-2-주가-예측-머신러닝-모델-학습">✔️ (2) 주가 예측 머신러닝 모델 학습</h3>

<p>앞서 불러온 주가 데이터셋으로 여러 개의 머신러닝 모델을 학습한다. 모델은 총 9개의 분류 알고리즘을 사용하여 비교한다. <br /> <br />
<strong>model list</strong></p>
<ul>
  <li>Logistic Regression</li>
  <li>Decision tree</li>
  <li>Support vector machine</li>
  <li>Gaussian naive bayes</li>
  <li>K nearest neighbor</li>
  <li>Random forest</li>
  <li>Gradient boosing</li>
  <li>Neural network</li>
  <li>
    <p>XGBoost</p>
  </li>
  <li>모델학습</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">results</span><span class="o">=</span><span class="p">[]</span>

<span class="c1">##### 1. Logistic regression    
</span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">lr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 2. Decision tree
</span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">()</span>
<span class="n">dt</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 3. Support vector machine
</span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">probability</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">svc</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 4. Gaussian naive bayes
</span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="n">gnb</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>
<span class="n">gnb</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 5. K nearest neighbor
</span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<span class="n">knn</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 6. Random forest
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">rf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 7. Gradient boosing
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="n">gb</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">()</span>
<span class="n">gb</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### 8. Neural network
</span><span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">mlp</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>

<span class="c1">##### XGBoost 
</span><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>
<span class="n">xgb</span> <span class="o">=</span> <span class="n">XGBClassifier</span><span class="p">(</span>
                   <span class="n">n_jobs</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                   <span class="n">scale_pos_weight</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                   <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                   <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                   <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
                   <span class="p">)</span> 

<span class="n">xgb</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">trainX</span><span class="p">,</span> <span class="n">trainY</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[00:14:01] WARNING: ../src/learner.cc:1115: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.





XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,
              colsample_bynode=1, colsample_bytree=1, enable_categorical=False,
              gamma=0, gpu_id=-1, importance_type=None,
              interaction_constraints='', learning_rate=0.01, max_delta_step=0,
              max_depth=3, min_child_weight=1, missing=nan,
              monotone_constraints='()', n_estimators=500, n_jobs=40,
              num_parallel_tree=1, predictor='auto', random_state=0,
              reg_alpha=0, reg_lambda=1, scale_pos_weight=4, subsample=1,
              tree_method='exact', validate_parameters=1, verbosity=None)
</code></pre></div></div>

<ul>
  <li>예측<br />
학습시킨 모델 별로 Accuracy와 AUC score를 측정하여, <code class="language-plaintext highlighter-rouge">lst_result_acc</code>, <code class="language-plaintext highlighter-rouge">lst_result_roc</code> 리스트에 추가한다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lst_model</span> <span class="o">=</span> <span class="p">[</span><span class="n">lr</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">svc</span><span class="p">,</span> <span class="n">gnb</span><span class="p">,</span> <span class="n">knn</span><span class="p">,</span> <span class="n">rf</span><span class="p">,</span> <span class="n">gb</span><span class="p">,</span> <span class="n">mlp</span><span class="p">,</span> <span class="n">xgb</span><span class="p">]</span>

<span class="n">dic_model2name</span> <span class="o">=</span> <span class="p">{</span><span class="n">lr</span><span class="p">:</span><span class="s">'LogisticRegression'</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span><span class="s">'DecisionTree'</span><span class="p">,</span> <span class="n">svc</span><span class="p">:</span><span class="s">'SVM'</span><span class="p">,</span> 
                  <span class="n">gnb</span><span class="p">:</span><span class="s">'GaussianNaiveBayes'</span><span class="p">,</span> <span class="n">knn</span><span class="p">:</span><span class="s">'KNN'</span><span class="p">,</span> <span class="n">rf</span><span class="p">:</span><span class="s">'RandomForest'</span><span class="p">,</span> 
                  <span class="n">gb</span><span class="p">:</span><span class="s">'GradientBoosting'</span><span class="p">,</span> <span class="n">mlp</span><span class="p">:</span><span class="s">'NeuralNetwork'</span><span class="p">,</span> <span class="n">xgb</span><span class="p">:</span><span class="s">'XGBoost'</span><span class="p">}</span>

<span class="n">lst_result_acc</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># [['모델명', train 평가지표, test 평가지표], ...]
</span><span class="n">lst_result_roc</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">lst_model</span><span class="p">:</span> 
    <span class="c1"># accuracy 
</span>    <span class="n">predY_train</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">trainX</span><span class="p">)</span>
    <span class="n">predY_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">testX</span><span class="p">)</span>
    
    <span class="n">accuracy_train</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">trainY</span><span class="p">,</span> <span class="n">predY_train</span><span class="p">)</span>
    <span class="n">accuracy_test</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">testY</span><span class="p">,</span> <span class="n">predY_test</span><span class="p">)</span>

    <span class="c1"># auc score 
</span>    <span class="n">probY_train</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">trainX</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">probY_test</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">testX</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="n">roc_score_train</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">trainY</span><span class="p">,</span> <span class="n">probY_train</span><span class="p">)</span>
    <span class="n">roc_score_test</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">testY</span><span class="p">,</span> <span class="n">probY_test</span><span class="p">)</span>
    
    <span class="c1"># 리스트에 추가 
</span>    <span class="n">lst_result_acc</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">dic_model2name</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">accuracy_train</span><span class="p">,</span> <span class="n">accuracy_test</span><span class="p">])</span>
    <span class="n">lst_result_roc</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">dic_model2name</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">roc_score_train</span><span class="p">,</span> <span class="n">roc_score_test</span><span class="p">])</span>
    
<span class="k">print</span><span class="p">(</span><span class="s">'accuracy list: '</span><span class="p">,</span> <span class="n">lst_result_acc</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">'auc score list: '</span><span class="p">,</span> <span class="n">lst_result_roc</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>accuracy list:  [['LogisticRegression', 0.7622957687473817, 0.7734145791017829], ['DecisionTree', 1.0, 0.598059128864816]]

auc score list:  [['LogisticRegression', 0.5318105913341066, 0.5430800870053489], ['DecisionTree', 1.0, 0.4824088530616373]]
</code></pre></div></div>

<h3 id="️-3-평가지표-시각화를-통한-모델-평가">✔️ (3) 평가지표 시각화를 통한 모델 평가</h3>

<p>위에서 얻은 9가지 모델의 평가 지표(<code class="language-plaintext highlighter-rouge">accuracy</code>, <code class="language-plaintext highlighter-rouge">auc score</code>) 결과 리스트를 받아 모델 별로 평가지표를 비교하는 <code class="language-plaintext highlighter-rouge">bar graph</code> 시각화 함수를 작성한다.<br />
<code class="language-plaintext highlighter-rouge">test</code> 데이터셋의 성능이 높은 순서대로 정렬하여 시각화 한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">result_plot</span><span class="p">(</span><span class="n">lst</span><span class="p">:</span><span class="nb">list</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span> 
    <span class="s">'''
    lst: [['모델명', 'train 평가지표', 'test 평가지표'], ...]
    index: 'acc' or 'auc'
    '''</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
    
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="s">'acc'</span><span class="p">:</span> 
        <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  
        <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"ACCURACY"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lst_result_acc</span><span class="p">,</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'train'</span><span class="p">,</span> <span class="s">'test'</span><span class="p">]).</span><span class="n">set_index</span><span class="p">(</span><span class="s">'name'</span><span class="p">)</span>
        
        <span class="n">df_results</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s">'name'</span><span class="p">)</span>
      
    <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="s">'auc'</span><span class="p">:</span> 
        <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  
        <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"ROCAUC"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lst_result_roc</span><span class="p">,</span> 
                     <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'train'</span><span class="p">,</span> <span class="s">'test'</span><span class="p">]).</span><span class="n">set_index</span><span class="p">(</span><span class="s">'name'</span><span class="p">)</span>
        <span class="n">df_results</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">().</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="s">'name'</span><span class="p">)</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"평가지표를 다시 입력해주세요."</span><span class="p">)</span>
        
      
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"name"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"value"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s">'variable'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_results</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span> 
                     <span class="n">order</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'test'</span><span class="p">].</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">).</span><span class="n">index</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.00</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="p">.</span><span class="n">get_xticklabels</span><span class="p">(),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span> 
    
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">get_height</span><span class="p">()</span>
        <span class="n">ax</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="p">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">ha</span> <span class="o">=</span> <span class="s">'center'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><strong><code class="language-plaintext highlighter-rouge">Accuracy</code></strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result_plot</span><span class="p">(</span><span class="n">lst_result_acc</span><span class="p">,</span> <span class="s">'acc'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/myblog/images/output_22_0.png" alt="png" /></p>

<p><strong><code class="language-plaintext highlighter-rouge">AUROC</code></strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result_plot</span><span class="p">(</span><span class="n">lst_result_acc</span><span class="p">,</span> <span class="s">'auc'</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/myblog/images/output_24_0.png" alt="png" /></p>

<p>Accuracy는 Logistic Regression, ROCAUC는 XGBoost가 가장 높은 값을 얻었다.</p>

<h3 id="️-4-모델-선택">✔️ (4) 모델 선택</h3>

<ul>
  <li><strong>1) 선택 기준 평가지표 선택 - 종속변수 불균형 문제</strong><br />
모델 선택을 위해 사용할 평가지표를 선택한다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">flatten</span><span class="p">()</span>

<span class="c1"># countplot 시각화
</span><span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">trainY</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">testY</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="c1"># title 설정
</span><span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"train"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">"test"</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="c1"># ylim 설정
</span><span class="n">ax1</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10500</span><span class="p">)</span>
<span class="n">ax2</span><span class="p">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3900</span><span class="p">)</span>

<span class="c1"># text 추가
</span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax1</span><span class="p">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">ax1</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="p">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">200</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s">'center'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax2</span><span class="p">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="n">ax2</span><span class="p">.</span><span class="n">text</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="p">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">80</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">ha</span> <span class="o">=</span> <span class="s">'center'</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># class 0, 1 비율 계산
</span><span class="k">print</span><span class="p">(</span><span class="s">"===============train==============="</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"0의 비율: "</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">trainY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">trainY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">trainY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"1의 비율: "</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">trainY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">trainY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">trainY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"===============test================"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"0의 비율: "</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">testY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">testY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">testY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"1의 비율: "</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">testY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">testY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">testY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)))</span>
<span class="k">print</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>===============train===============
0의 비율:  0.7622957687473817
1의 비율:  0.23770423125261836

===============test================
0의 비율:  0.7734145791017829
1의 비율:  0.2265854208982171
</code></pre></div></div>

<p><img src="output_28_1.png" alt="png" /></p>

<p>이진분류 된 종속변수를 <code class="language-plaintext highlighter-rouge">countplot</code>으로 시각화하여 분포를 살펴보았을 때, 종속변수가 0인 데이터의 비율이 높은 것을 확인할 수 있다. 이는 모델이 모두 0이라고 예측해도 정확도가 76~77%가 나온다는 뜻이다. 따라서 정확도는 해당 주가 데이터를 평가하기 위한 지표로는 신뢰성이 떨어진다고 판단되어, <code class="language-plaintext highlighter-rouge">threshold</code>별 <code class="language-plaintext highlighter-rouge">score</code>가 결정되는 <code class="language-plaintext highlighter-rouge">ROCAUC score</code>를 기준으로 모델을 선택한다.</p>

<ul>
  <li><strong>2) 예측 신뢰성</strong> <br />
<code class="language-plaintext highlighter-rouge">test dataset</code>의 <code class="language-plaintext highlighter-rouge">AUC</code>가 높은 상위 2개 모델(<code class="language-plaintext highlighter-rouge">XGBoost</code>, <code class="language-plaintext highlighter-rouge">GradientBoosting</code>)의 예측 확률을 살펴본다.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">xgb_prob</span> <span class="o">=</span> <span class="n">xgb</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">testX</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span> 
<span class="n">gb_prob</span> <span class="o">=</span> <span class="n">gb</span><span class="p">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">testX</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="s">'XGB:'</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xgb_prob</span> <span class="o">&gt;=</span> <span class="mf">0.6</span><span class="p">),</span> <span class="s">'개'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'GB:'</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">gb_prob</span> <span class="o">&gt;=</span> <span class="mf">0.6</span><span class="p">),</span> <span class="s">'개'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>XGB: 1268 개
GB: 1 개
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">class</code>를 <code class="language-plaintext highlighter-rouge">1</code>로 예측할 확률이 <code class="language-plaintext highlighter-rouge">60%</code> 이상인 데이터의 개수를 확인해보면, <code class="language-plaintext highlighter-rouge">XGBoost</code>는 <code class="language-plaintext highlighter-rouge">1268</code>개, <code class="language-plaintext highlighter-rouge">GradientBoosting</code>은 <code class="language-plaintext highlighter-rouge">1</code>개가 나온다.</p>

<hr />

<p><strong>1)</strong>, <strong>2)</strong> 를 근거로 하여 여러 머신러닝 모델 중 <code class="language-plaintext highlighter-rouge">AUC</code> 점수 1위인 동시에, 예측 신뢰성이 더 높다고 판단되는 <strong><code class="language-plaintext highlighter-rouge">XGBoost</code></strong> 를 최종적으로 <code class="language-plaintext highlighter-rouge">baseline</code> 머신러닝 모델로 결정한다.</p>

<h3 id="️-baseline-모델-정리-및-수익률-측정">✔️ baseline 모델 정리 및 수익률 측정</h3>

<p><strong>baseline 모델 정리</strong></p>

<ul>
  <li><strong>데이터</strong>
    <ul>
      <li>종목: kospi + kosdaq 주식 시장 3년 이상 존속하였던 종목들</li>
      <li>기간: 2018.01.01-2020.12.31 (총 3년)</li>
      <li>필터링: 거래대금 1000억 이상</li>
      <li>구조: 10일 간의 데이터들을 feature로 두어 시계열 데이터셋 생성</li>
    </ul>
  </li>
  <li>
    <p><strong>모델</strong><br />
XGBClassifier(<br />
              n_jobs=40,<br />
              scale_pos_weight=4,<br />
              learning_rate=0.01,<br />
              max_depth=3,<br />
              n_estimators=500,</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>             ) 
</code></pre></div>    </div>
  </li>
</ul>

<p><strong>수익률 측정</strong><br />
baseline모델을 선정하였으므로 프로젝트에서 중요한 부분인 수익률 측정을 수행한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">'XGB:'</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="n">xgb_prob</span> <span class="o">&gt;=</span> <span class="mf">0.65</span><span class="p">),</span> <span class="s">'개'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>XGB: 34 개
</code></pre></div></div>

<p>해당 수익률 계산 시뮬레이션에서는 prob 임계값을 0.65로 설정함으로써 6개월 동안 1~2주에 한번 꼴로 매매가 이루어지도록 한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">compute_earnings_rate</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">,</span> <span class="n">probY</span><span class="p">):</span>
    <span class="c1">##### DB 
</span>    <span class="n">db_dsml</span> <span class="o">=</span> <span class="n">pymysql</span><span class="p">.</span><span class="n">connect</span><span class="p">(</span>
        <span class="n">host</span> <span class="o">=</span> <span class="s">'localhost'</span><span class="p">,</span> 
        <span class="n">port</span> <span class="o">=</span> <span class="mi">3306</span><span class="p">,</span> 
        <span class="n">user</span> <span class="o">=</span> <span class="s">'[db username]'</span><span class="p">,</span> 
        <span class="n">passwd</span> <span class="o">=</span> <span class="s">'[db password]'</span><span class="p">,</span> 
        <span class="n">db</span> <span class="o">=</span> <span class="s">'[db name]'</span><span class="p">,</span> 
        <span class="n">charset</span> <span class="o">=</span> <span class="s">'utf8'</span>
    <span class="p">)</span>
    
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db_dsml</span><span class="p">.</span><span class="n">cursor</span><span class="p">()</span>
    
    <span class="c1">##### 주문 일지 작성 #####
</span>    <span class="n">lst_output</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">),</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lst_code_date</span><span class="p">,</span> <span class="n">probY</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mf">0.65</span><span class="p">:</span> <span class="c1"># 예측 확률 (probY) 임계값 0.65 
</span>            <span class="n">lst_output</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="s">"buy"</span><span class="p">,</span> <span class="s">"all"</span><span class="p">])</span>  
            <span class="n">lst_output</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="o">+</span><span class="s">"n"</span><span class="p">,</span> <span class="s">"sell"</span><span class="p">,</span> <span class="s">"all"</span><span class="p">])</span>  
            
    <span class="n">lst_output</span><span class="p">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># 날짜로 정렬 
</span>    
    
    <span class="c1">##### 수익률 계산 #####
</span>    <span class="n">start_money</span> <span class="o">=</span> <span class="mi">10000000</span> <span class="c1"># 초기 현금 1천만원
</span>    <span class="n">money</span> <span class="o">=</span> <span class="n">start_money</span>
    <span class="n">dic_code2num</span> <span class="o">=</span><span class="p">{}</span>  <span class="c1"># 보유 종목
</span>    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">lst_output</span><span class="p">)):</span> <span class="c1"># 주문 일지를 한 줄 읽어 옴
</span>        <span class="n">code</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">amount</span> <span class="o">=</span> <span class="n">row</span>

        <span class="n">sql_query</span> <span class="o">=</span> <span class="s">'''
                    SELECT *
                    FROM stock_{}
                    WHERE Date BETWEEN '2021-01-01' AND '2021-06-31'
                    '''</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
        <span class="n">stock</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span> <span class="o">=</span> <span class="n">sql_query</span><span class="p">,</span> <span class="n">con</span> <span class="o">=</span> <span class="n">db_dsml</span><span class="p">)</span>
        <span class="n">lst_data</span> <span class="o">=</span> <span class="n">stock</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="n">tolist</span><span class="p">()</span>    

        
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lst_data</span><span class="p">):</span>
            <span class="n">data_date</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">date</span><span class="p">().</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%Y%m%d'</span><span class="p">)</span>

            <span class="k">if</span> <span class="s">'n'</span> <span class="ow">in</span> <span class="n">date</span><span class="p">:</span> <span class="c1"># 매도 날짜
</span>                <span class="n">date_n</span> <span class="o">=</span> <span class="n">date</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">data_date</span> <span class="o">==</span> <span class="n">date_n</span><span class="p">:</span> 
                    <span class="n">close</span> <span class="o">=</span> <span class="n">lst_data</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># 매도 할 종가 (매수 다음날 종가)
</span>                    <span class="k">break</span>            

            <span class="k">else</span><span class="p">:</span> <span class="c1"># 매수 날짜 
</span>                <span class="k">if</span> <span class="n">data_date</span> <span class="o">==</span> <span class="n">date</span><span class="p">:</span>
                    <span class="n">close</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># 매수 할 종가 
</span>                    <span class="k">break</span>
        
        <span class="k">if</span> <span class="n">request</span> <span class="o">==</span> <span class="s">'buy'</span><span class="p">:</span> <span class="c1"># 매수 
</span>            <span class="k">if</span> <span class="n">amount</span><span class="p">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">'r'</span><span class="p">):</span> <span class="c1"># 분할 매수 시 사용 
</span>                <span class="n">request_money</span> <span class="o">=</span> <span class="n">money</span> <span class="o">*</span> <span class="nb">float</span><span class="p">(</span><span class="n">amount</span><span class="p">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s">"r"</span><span class="p">))</span> <span class="o">/</span> <span class="mi">100</span>
            <span class="k">elif</span> <span class="n">amount</span> <span class="o">==</span> <span class="s">'all'</span><span class="p">:</span>
                <span class="n">request_money</span> <span class="o">=</span> <span class="n">money</span>
            <span class="k">elif</span> <span class="n">amount</span><span class="p">.</span><span class="n">isdigit</span><span class="p">():</span>
                <span class="n">request_money</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Not permitted option'</span><span class="p">)</span>
                
            <span class="n">request_money</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">request_money</span><span class="p">,</span> <span class="n">money</span><span class="p">)</span>
            
            <span class="n">buy_num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request_money</span> <span class="o">/</span> <span class="n">close</span><span class="p">)</span> <span class="c1"># 매수 개수 
</span>            
            <span class="n">money</span> <span class="o">-=</span> <span class="n">buy_num</span> <span class="o">*</span> <span class="n">close</span>  <span class="c1"># 매수 후 잔고 업데이트 
</span>            
            <span class="k">if</span> <span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic_code2num</span><span class="p">:</span> <span class="c1"># 현재 보유종목이 아니라면 
</span>                <span class="n">dic_code2num</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># dict에 key 생성 
</span>                
            <span class="n">dic_code2num</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">+=</span> <span class="n">buy_num</span> <span class="c1"># 해당 종목의 보유 개수 업데이트
</span>            
        <span class="k">if</span> <span class="n">request</span> <span class="o">==</span> <span class="s">'sell'</span><span class="p">:</span> <span class="c1"># 매도 
</span>            <span class="k">if</span> <span class="n">amount</span> <span class="o">==</span> <span class="s">'all'</span><span class="p">:</span>   
                <span class="n">sell_num</span> <span class="o">=</span> <span class="n">dic_code2num</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="c1"># 해당 종목의 보유하고 있는 모든 개수 매도
</span>            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Not permitted option'</span><span class="p">)</span>       
                
            <span class="n">money</span> <span class="o">+=</span> <span class="n">sell_num</span> <span class="o">*</span> <span class="n">close</span> <span class="c1"># 매도 후 잔고 업데이트 
</span>            
            <span class="n">dic_code2num</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">-=</span> <span class="n">sell_num</span> <span class="c1"># 해당 종목 매도 후 보유 개수 업데이트 
</span>            <span class="k">if</span> <span class="n">dic_code2num</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># 해당 종목이 보유하고 있는 개수가 없다면 
</span>                <span class="k">del</span> <span class="n">dic_code2num</span><span class="p">[</span><span class="n">code</span><span class="p">]</span> <span class="c1"># 보유종목에서 삭제 
</span>
    <span class="k">if</span> <span class="n">dic_code2num</span> <span class="o">!=</span> <span class="p">{}:</span> <span class="c1"># 주문일지를 모두 돌고난 후에는 보유종목 dict가 비어있어야 함. 
</span>        <span class="k">raise</span> <span class="nb">Exception</span><span class="p">(</span><span class="s">'Not empty stock'</span><span class="p">)</span> 

    <span class="k">print</span><span class="p">(</span><span class="s">"Final earning rate : {} %"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">money</span><span class="o">-</span><span class="n">start_money</span><span class="p">)</span> <span class="o">/</span> <span class="n">start_money</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)))</span>
<span class="c1">#     return str((money-start_money) / start_money * 100)
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">compute_earnings_rate</span><span class="p">(</span><span class="n">lst_code_date_test</span><span class="p">,</span> <span class="n">xgb_prob</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>100%|█████████████████████████████████████████████| 68/68 [00:00&lt;00:00, 265.33it/s]

Final earning rate : 54.73516000000001 %
</code></pre></div></div>

<p>최종적으로 baseline 모델의 수익률을 계산해봤을 때, 6개월간의 총 수익률은 약 54%가 나왔다. 평가지표인 ROCAUC score는 낮은 편에 속했지만, 높은 수익률을 보였다. <br />
다음 글 부터는 <code class="language-plaintext highlighter-rouge">data preprocessing</code>을 진행하며, 주가 빅데이터의 질을 높여  baseline model 보다 뛰어난 성능을 보이도록 개선한다.</p>

      <div class="c-article__footer u-clearfix">
        <div class="c-article__tag">
          
        </div>
        <div class="c-article__share">
          <a href="https://twitter.com/intent/tweet?text=Stock%20Research%20%7C%7C%201.2.%20%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D%20%EB%AA%A8%EB%8D%B8%20%EB%B9%84%EA%B5%90&url=https://ag-su.github.io/2022/07/08/model-selection/" title="Share
          on Twitter" rel="nofollow" target="_blank"><div data-icon='ei-sc-twitter' data-size='s'></div></a>
          <a href="https://facebook.com/sharer.php?u=https://ag-su.github.io/2022/07/08/model-selection/" title="Share on Facebook" rel="nofollow" target="_blank"><div data-icon='ei-sc-facebook' data-size='s'></div></a>
          <a href="https://plus.google.com/share?url=https://ag-su.github.io/2022/07/08/model-selection/" title="Share on Google+" rel="nofollow" target="_blank"><div data-icon='ei-sc-google-plus' data-size='s'></div></a>
        </div>
      </div>
      <div class="c-newsletter">
  <div class="c-newsletter__header">
    <h4 class="c-newsletter__title">Newsletter</h4>
    <div class="c-newsletter__subtitle">Subscribe to this blog and receive notifications of new posts by email.</div>
  </div>
  <form class="c-newsletter-form validate" action="#" method="POST" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" novalidate>
    <div class="c-newsletter-form__group">
      <label class="u-screen-reader-text" for="mce-EMAIL">Email address</label>
      <input class="c-newsletter__email required email" id="mce-EMAIL" type="email" name="EMAIL" placeholder="Your email address" autocomplete="on">
      <input class="c-newsletter__button" id="mc-embedded-subscribe" type="submit" name="subscribe" value="Subscribe">
    </div>
  </form>
</div> <!-- /.c-newsletter -->
      <div class="c-recent-post">
        <h4 class="c-recent__title">You might also enjoy</h4>
        <div class="c-recent__box">
        
        
          <div class="c-recent__item">
            <a class="c-recent__image" href="/2022/10/19/credit-card-fraud-detection/" style="background-image: url( /myblog/images/01.credit_thumbnail.png)"></a>
            <div class="c-recent__footer">
              <h4><a href="/2022/10/19/credit-card-fraud-detection/">Transcription || [Kaggle] Credit card Fraud Detection</a></h4>
              <div class="c-recent__date">
                <time datetime="2022-10-19T00:00:00+09:00">October 19, 2022</time>
              </div>
            </div>
          </div>
        
        
        
          <div class="c-recent__item">
            <a class="c-recent__image" href="/2022/07/09/add-index/" style="background-image: url( /myblog/images/03.thumbnail.png)"></a>
            <div class="c-recent__footer">
              <h4><a href="/2022/07/09/add-index/">Stock Research || 2.1 주가 데이터셋 보조지표 추가</a></h4>
              <div class="c-recent__date">
                <time datetime="2022-07-09T00:00:00+09:00">July 9, 2022</time>
              </div>
            </div>
          </div>
        
        
        
          <div class="c-recent__item">
            <a class="c-recent__image" href="/2022/07/06/stock-dataset/" style="background-image: url( /myblog/images/01.thumbnail.png)"></a>
            <div class="c-recent__footer">
              <h4><a href="/2022/07/06/stock-dataset/">Stock Research || 1.1. 머신러닝을 위한 주가 데이터셋 생성</a></h4>
              <div class="c-recent__date">
                <time datetime="2022-07-06T00:00:00+09:00">July 6, 2022</time>
              </div>
            </div>
          </div>
        
        
        
          <div class="c-recent__item">
            <a class="c-recent__image" href="/2022/04/12/implementation/" style="background-image: url( /myblog/images/02.implementation_1.png)"></a>
            <div class="c-recent__footer">
              <h4><a href="/2022/04/12/implementation/">Algorithm || 구현 Implementation</a></h4>
              <div class="c-recent__date">
                <time datetime="2022-04-12T00:00:00+09:00">April 12, 2022</time>
              </div>
            </div>
          </div>
        
        
        </div>
      </div> <!-- /.c-recent-post -->
      
        <div class="c-comments">
  <div id="disqus_thread" class="article-comments"></div>
  <script>
    (function () {
      var d = document, s = d.createElement('script');
      s.src = '//mr-brown.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
</div> <!-- /.c-comments -->
      
    </div> <!-- /.c-wrap-content -->
  </div> <!-- /.c-article__content -->
</article> <!-- /.c-article-page -->

</main> <!-- /.c-content -->
  </div> <!-- /.o-wrapper -->
  <div class="c-top" data-icon='ei-chevron-up' data-size='s' title="Scroll To Top"></div> <!-- /.c-top -->
  <script src="/myblog/js/jquery-3.3.1.min.js"></script>
<script src="/myblog/js/evil-icons.min.js"></script>
<script src="/myblog/js/jquery.fitvids.js"></script>
<script src="/myblog/js/simple-jekyll-search.min.js"></script>
<script src="/myblog/js/main.js"></script>
<!-- /javascripts -->
</body>
</html>